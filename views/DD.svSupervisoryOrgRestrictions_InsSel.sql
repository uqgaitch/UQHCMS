SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER view [DD].[svSupervisoryOrgRestrictions_InsSel] as 

select distinct [Back to ToC], Group2, Group3, Group4, Group5, Group6, Group7, Group8, 
Group9, Group10, Reference_ID, Value, 'Mercer' as [Organization Type Reference ID]
, max(isnull(T122F010_COSTING_CODE_1,'') + '-' + isnull(T122F015_COSTING_CODE_2,'') + CASE WHEN T122F020_COSTING_CODE_3 IS NULL THEN '' ELSE '-' END + isnull(T122F020_COSTING_CODE_3,'')) as [Allowed Organization Reference ID]
, max(isnull(T122F010_COSTING_CODE_1,'') + '-' + isnull(T122F015_COSTING_CODE_2,'') + CASE WHEN T122F020_COSTING_CODE_3 IS NULL THEN '' ELSE '-' END + isnull(T122F020_COSTING_CODE_3,'')) as [Default Organization Reference ID]

FROM DD.SupervisoryOrganisation a 
inner join [AUR].[T122_ORGANISATION_UNIT_COSTING] b
on cast(a.[Back to ToC] as nvarchar(10)) = cast(b.[T122F005_ORGANISATION_UNIT_NO] as nvarchar(10))
where a.[Back to ToC] in 

('116',
'120',
'126',
'130',
'148',
'150',
'151',
'153',
'154',
'155',
'165',
'176',
'177',
'178',
'179',
'180',
'190',
'198',
'208',
'209',
'210',
'211',
'212',
'213',
'219',
'257',
'278',
'321',
'322',
'323',
'362',
'373',
'374',
'375',
'376',
'377',
'379',
'381',
'383',
'389',
'390',
'391',
'392',
'393',
'394',
'395',
'396',
'397',
'399',
'400',
'401',
'402',
'403',
'404',
'407',
'408',
'410',
'416',
'417',
'418',
'428',
'429',
'440',
'442',
'443',
'454',
'456',
'466',
'473',
'474',
'488',
'489',
'529',
'543',
'551',
'552',
'553',
'555',
'560',
'572',
'573',
'580',
'585',
'600',
'601',
'603',
'604',
'619',
'620',
'621',
'622',
'626',
'628',
'629',
'630',
'631',
'632',
'633',
'634',
'635',
'636',
'637',
'638',
'641',
'645',
'647',
'648',
'663',
'699',
'700',
'701',
'702',
'704',
'715',
'718',
'719',
'725',
'727',
'728',
'729',
'730',
'731',
'732',
'733',
'734',
'735',
'736',
'737',
'738',
'739',
'741',
'742',
'743',
'744',
'745',
'746',
'747',
'748',
'749',
'750',
'751',
'752',
'753',
'771',
'772',
'773',
'774',
'775',
'786',
'796',
'797',
'801',
'803')

group by [Back to ToC], Group2, Group3, Group4, Group5, Group6, Group7, Group8, 
Group9, Group10, Reference_ID, Value--, [Organization Type Reference ID]


--SELECT * FROM [AUR].[T122_ORGANISATION_UNIT_COSTING] where T122F005_ORGANISATION_UNIT_NO = '727'
--select * from [AUR].[T106_ORGANISATION_UNITS] where T106F005_ORGANISATION_UNIT_NO = '727'
GO
