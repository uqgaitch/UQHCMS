SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER view [AUR].[HRDC009_EmployeeOneTimePayments_InsSel] as 

SELECT DISTINCT
   T001.T001F005_EMPLOYEE_NO as EmployeeID
 , T001.T001F065_ACTUAL_POSITION_NO as PositionID
 , T510.T510F050_DATE_FROM as EffectiveDate
 , T510.T510F085_REASON_CODE as ReasonReference
 , T510.T510F070_ALLOW_DEDN_CODE as OneTimePaymentPlan
 , T510.T510F140_AMOUNT as Amount
 , 'AUD' as CurrencyCode

FROM AUR.[T001_BASIC_DETAILS] T001
INNER JOIN [AUR].[T510_PAYROLL_TRANSACTION] T510
on t001.T001F005_EMPLOYEE_NO = T510.T510F005_EMPLOYEE_NO
WHERE T001F015_EMPLOYEE_STATUS <> 'TERMINATED'
AND T510F050_DATE_FROM > getdate() - 100

GO
