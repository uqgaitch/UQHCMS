SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER view [AUR].[HRDC018_EmployeeOneTimeOffEvents_InsSel] as 

SELECT DISTINCT
   T001.T001F005_EMPLOYEE_NO as EmployeeID
 , T522.T522F040_DATE_FROM as TimeOffDate
 , t522.T522F190_PERIOD_MINS as TimeOffUnits
 , T522.T522F015_LEAVE_TYPE as TimeOffTypeNameOrCode

FROM AUR.[T001_BASIC_DETAILS] T001
INNER JOIN [AUR].T522_LEAVE_OCCURRENCE T522
on t001.T001F005_EMPLOYEE_NO = T522.T522F005_EMPLOYEE_NO
WHERE T001F015_EMPLOYEE_STATUS <> 'TERMINATED'
AND t522.T522F040_DATE_FROM > getdate()-100

GO
